<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Cards</title>
    <link rel="stylesheet" href="oststyle.css">
</head>
<body>
    <input type="text" id="search" placeholder="Search songs..." onkeyup="filterSongs()">
    <div id="cards-container"></div>

    <div class="buttons">
        <a href="index.html"><button>Main Menu</button></a>
        <a href="catalog.html"><button>Catalog</button></a>
        <a href="battle.html"><button>Battle</button></a>
        <a href="map.html"><button>Map</button></a>
    </div>

    <script>
        const audioFiles = [
            { name: "Humble Ashore", file: "ost/HumbleAshore.mp3", image: ".png", ost: 1000 },
            { name: "Skeptic Electric", file: "ost/SkepticElectric.mp3", image: ".png", ost: 1000 },
            { name: "Hectic Electric", file: "ost/HecticElectric.mp3", image: ".png", ost: 1000 },
            { name: "Power Outage / Circuit Breaker", file: "ost/PowerOutage.mp3", image: ".png", ost: 1000 },
            { name: "Skibidi Electric", file: "ost/SkibidiElectric.mp3", image: ".png", ost: 1000 },
            { name: "Distant Rumbles", file: "ost/DistantRumbles.mp3", image: ".png", ost: 1000 },
            { name: "Tumbling Rumbles", file: "ost/TumblingRumbles.mp3", image: ".png", ost: 1000 }
        ];

        const container = document.getElementById("cards-container");

        function displaySongs(filteredFiles) {
    container.innerHTML = "";
    filteredFiles.forEach(({ name, file, image }) => {
        const card = document.createElement("div");
        card.className = "card";
        card.setAttribute("data-name", name.toLowerCase());

        card.innerHTML = `
            <img src="${image}" alt="${name}" width="100%">
            <h3>${name}</h3>
            <button onclick="playAudio(this)">Play</button>
            <div class="progress">
                <div class="progress-bar"></div>
            </div>
            <p class="time-display">0:00 / 0:00</p>
            <audio src="${file}" loop onloadedmetadata="updateTotalTime(this)" ontimeupdate="updateProgress(this)"></audio>
        `;

        container.appendChild(card);
    });
}

function displaySongs(filteredFiles) {
    container.innerHTML = "";
    filteredFiles.forEach(({ name, file, image }) => {
        const card = document.createElement("div");
        card.className = "card";
        card.setAttribute("data-name", name.toLowerCase());

        card.innerHTML = `
            <img src="${image}" alt="${name}" width="100%">
            <h3>${name}</h3>
            <button onclick="playAudio(this)">Play</button>
            <div class="progress" onclick="seekAudio(event, this)">
                <div class="progress-bar"></div>
            </div>
            <p class="time-display">0:00 / 0:00</p>
            <audio src="${file}" loop onloadedmetadata="updateTotalTime(this)" ontimeupdate="updateProgress(this)"></audio>
        `;

        container.appendChild(card);
    });
}
        function playAudio(button) {
            const card = button.parentElement;
            const audio = card.querySelector("audio");

            if (audio.paused) {
                audio.play();
                button.textContent = "Pause";
            } else {
                audio.pause();
                button.textContent = "Play";
            }

            audio.onended = () => { button.textContent = "Play"; };
        }

        function updateProgress(audio) {
            const progressBar = audio.parentElement.querySelector(".progress-bar");
            const timeDisplay = audio.parentElement.querySelector(".time-display");
            
            const currentTime = formatTime(audio.currentTime);
            const totalTime = formatTime(audio.duration);
            
            progressBar.style.width = (audio.currentTime / audio.duration) * 100 + "%";
            timeDisplay.textContent = `${currentTime} / ${totalTime}`;
        }

        function updateTotalTime(audio) {
            const timeDisplay = audio.parentElement.querySelector(".time-display");
            timeDisplay.textContent = `0:00 / ${formatTime(audio.duration)}`;
        }

        function formatTime(seconds) {
            if (isNaN(seconds)) return "0:00";
            const min = Math.floor(seconds / 60);
            const sec = Math.floor(seconds % 60);
            return `${min}:${sec < 10 ? "0" : ""}${sec}`;
        }

        function seekAudio(event, progressElement) {
            const audio = progressElement.parentElement.querySelector("audio");
            const rect = progressElement.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const percentage = clickX / rect.width;
            
            if (!isNaN(audio.duration)) {
                audio.currentTime = percentage * audio.duration;
            }
        }

        displaySongs(audioFiles);
    </script>
</body>
</html>
